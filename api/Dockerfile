FROM python:3.9-buster
  
# Setup args
ARG TESTNET_ADDRESS
ARG TESTNET_PRIVATE_KEY
ARG CONSUMER_KEY
ARG CONSUMER_SECRET
ARG ACCESS_TOKEN_KEY
ARG ACCESS_TOKEN_SECRET
ARG PROXY_URL

# Setup ENV

ENV TZ Asia/Shanghai
ENV TESTNET_ADDRESS $TESTNET_ADDRESS
ENV TESTNET_PRIVATE_KEY $TESTNET_PRIVATE_KEY
ENV CONSUMER_KEY $CONSUMER_KEY
ENV CONSUMER_SECRET $CONSUMER_SECRET
ENV ACCESS_TOKEN_KEY $ACCESS_TOKEN_KEY
ENV ACCESS_TOKEN_SECRET $ACCESS_TOKEN_SECRET

ENV DEV_ENV testnet
ENV FLOW_ACCOUNT_KEY_ID 0
ENV PROXY_URL $PROXY_URL

# Prepare environment
RUN mkdir -p /FanNFT/api

# Install dependencies
COPY . /FanNFT/api
RUN cp -r /FanNFT/api/cadence /FanNFT
WORKDIR /FanNFT/api
RUN  pip install --user --no-cache-dir -r requirements.txt

# Run code
CMD ["python","main.py"]