import{SUBSCRIBE as n,UNSUBSCRIBE as r,spawn as e,send as t,subscriber as o}from"@onflow/util-actor";var i,u="config",f="PUT_CONFIG",c="GET_CONFIG",l="CONFIG/UPDATED",a=function(n){return n},s=((i={})[f]=function(n,r,e){var t=e.key,o=e.value;if(null==t)throw new Error("Missing 'key' for config/put.");n.put(t,o),n.broadcast(l,n.all())},i[c]=function(n,r,e){var t=e.key,o=e.fallback;if(null==t)throw new Error("Missing 'key' for config/get");r.reply(n.get(t,o))},i.UPDATE_CONFIG=function(n,r,e){var t=e.key,o=e.fn;if(null==t)throw new Error("Missing 'key' for config/update");n.update(t,o||a),n.broadcast(l,n.all())},i.DELETE_CONFIG=function(n,r,e){var t=e.key;if(null==t)throw new Error("Missing 'key' for config/delete");n.delete(t),n.broadcast(l,n.all())},i.WHERE_CONFIG=function(n,r,e){var t=e.pattern;if(null==t)throw new Error("Missing 'pattern' for config/where");r.reply(n.where(t))},i[n]=function(n,r){n.subscribe(r.from),n.send(r.from,l,n.all())},i[r]=function(n,r){n.unsubscribe(r.from)},i);function E(n,r){return t(u,f,{key:n,value:r}),b()}function p(n,r){return t(u,c,{key:n,fallback:r},{expectReply:!0,timeout:10})}function y(n,r){return void 0===r&&(r=a),t(u,"UPDATE_CONFIG",{key:n,fn:r}),b()}function g(n){return t(u,"DELETE_CONFIG",{key:n}),b()}function k(n){return t(u,"WHERE_CONFIG",{pattern:n},{expectReply:!0,timeout:10})}function w(n){return o(u,function(){return e(s,u)},n)}function b(){return{put:E,get:p,update:y,delete:g,where:k,subscribe:w}}e(s,u);export{b as config};
//# sourceMappingURL=config.module.js.map
