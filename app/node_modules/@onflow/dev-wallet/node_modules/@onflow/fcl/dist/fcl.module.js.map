{"version":3,"file":"fcl.module.js","sources":["../src/default-config.js","../src/resolve/index.js","../src/send/index.js","../src/serialize/index.js","../src/decode/index.js","../src/transaction/index.js","../src/events/index.js","../src/address/index.js","../src/current-user/render-frame.js","../src/current-user/url-from-service.js","../src/current-user/render-authz-frame.js","../src/current-user/poll-for-authz-updates.js","../src/current-user/validate-composite-signature.js","../src/current-user/uid.js","../src/current-user/exec-authz-service.js","../src/current-user/index.js","../src/current-user/service-of-type.js","../src/current-user/render-authn-frame.js","../src/current-user/fetch-services.js","../src/current-user/merge-services.js","../src/fcl.js"],"sourcesContent":["import {config} from \"@onflow/config\"\n\nconfig()\n  .put(\"accessNode.api\", \"http://localhost:8080\")\n  .put(\"challenge.handshake\", \"http://localhost:8700/authenticate\")\n","import {\n  resolve as sdkResolve,\n  resolveParams,\n  resolveArguments,\n  resolveAccounts,\n  resolveSignatures,\n  resolveValidators,\n  resolveRefBlockId,\n  // resolveProposerSequenceNumber,\n} from \"@onflow/sdk\"\nimport {config} from \"@onflow/config\"\n\nexport const resolve = async ix => {\n  return sdkResolve(ix, [\n    resolveRefBlockId({node: await config().get(\"accessNode.api\")}),\n    // resolveProposerSequenceNumber({ node: await config().get(\"accessNode.api\") }),\n    resolveParams,\n    resolveArguments,\n    resolveAccounts,\n    resolveSignatures,\n    resolveValidators,\n  ])\n}\n","import {build, send as sdkSend} from \"@onflow/sdk\"\nimport {config} from \"@onflow/config\"\nimport {resolve} from \"../resolve\"\n\nexport const send = async (args = [], opts = {}) => {\n  opts.node = opts.node || (await config().get(\"accessNode.api\"))\n  if (Array.isArray(args)) args = build(args)\n  return sdkSend(await resolve(args), opts)\n}\n","import {build} from \"@onflow/sdk\"\nimport {resolve} from \"../resolve\"\n\nexport const serialize = async (args = []) => {\n  if (Array.isArray(args)) args = await build(args)\n  return JSON.stringify(await resolve(args))\n}\n","import {decodeResponse} from \"@onflow/sdk\"\nimport {config} from \"@onflow/config\"\n\nexport const decode = async response => {\n  const decodersFromConfig = await config().where(/^decoder\\./)\n  const decoders = Object.fromEntries(\n    Object.entries(decodersFromConfig).map(([pattern, xform]) => {\n      pattern = `/${pattern.replace(/^decoder\\./, \"\")}$/`\n      return [pattern, xform]\n    })\n  )\n  return decodeResponse(response, decoders)\n}\n","import \"../default-config\"\nimport {config} from \"@onflow/config\"\nimport {\n  spawn,\n  send,\n  subscriber,\n  snapshoter,\n  UPDATED,\n  SNAPSHOT,\n  INIT,\n  SUBSCRIBE,\n  UNSUBSCRIBE,\n} from \"@onflow/util-actor\"\nimport {send as fclSend} from \"../send\"\nimport {decode} from \"../decode\"\nimport {getTransactionStatus} from \"@onflow/sdk\"\n\nconst RATE = 2500\nconst POLL = \"POLL\"\n\nconst fetchTxStatus = async transactionId => {\n  const response = await fclSend([getTransactionStatus(transactionId)])\n  return decode(response)\n}\n\nconst isExpired = tx => tx.status === 5\nconst isSealed = tx => tx.status >= 4\nconst isExecuted = tx => tx.status >= 3\nconst isFinalized = tx => tx.status >= 2\nconst isPending = tx => tx.status >= 1\nconst isUnknown = tx => tx.status >= 0\n\nconst isDiff = (cur, next) => {\n  return JSON.stringify(cur) !== JSON.stringify(next)\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    const tx = await fetchTxStatus(ctx.self())\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE)\n    ctx.merge(tx)\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, ctx.all())\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply(ctx.all())\n  },\n  [POLL]: async ctx => {\n    const tx = await fetchTxStatus(ctx.self())\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE)\n    if (isDiff(ctx.all(), tx)) ctx.broadcast(UPDATED, tx)\n    ctx.merge(tx)\n  },\n}\n\nconst scoped = transactionId => {\n  if (typeof transactionId === \"object\")\n    transactionId = transactionId.transactionId\n  if (transactionId == null) throw new Error(\"transactionId required\")\n  return transactionId\n}\n\nconst spawnTransaction = transactionId => {\n  return spawn(HANDLERS, scoped(transactionId))\n}\n\nexport function transaction(transactionId) {\n  function snapshot() {\n    return snapshoter(transactionId, spawnTransaction)\n  }\n\n  function subscribe(callback) {\n    return subscriber(scoped(transactionId), spawnTransaction, callback)\n  }\n\n  function once(predicate) {\n    return function innerOnce(opts = {}) {\n      const suppress = opts.suppress || false\n      return new Promise((resolve, reject) => {\n        const unsub = subscribe(txStatus => {\n          if (txStatus.statusCode && !suppress) {\n            reject(txStatus.errorMessage)\n            unsub()\n          } else if (predicate(txStatus)) {\n            resolve(txStatus)\n            unsub()\n          }\n        })\n      })\n    }\n  }\n\n  return {\n    snapshot,\n    subscribe,\n    onceFinalized: once(isFinalized),\n    onceExecuted: once(isExecuted),\n    onceSealed: once(isSealed),\n  }\n}\n\ntransaction.isUnknown = isUnknown\ntransaction.isPending = isPending\ntransaction.isFinalized = isFinalized\ntransaction.isExecuted = isExecuted\ntransaction.isSealed = isSealed\ntransaction.isExpired = isExpired\n","import {spawn, subscriber, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {config} from \"@onflow/config\"\nimport {getLatestBlock, getEvents} from \"@onflow/sdk\"\nimport {send} from \"../send\"\nimport {decode} from \"../decode\"\n\nconst RATE = 10000\nconst UPDATED = \"UPDATED\"\nconst TICK = \"TICK\"\n\nconst currentBlock = async () => {\n  return decode(await send([getLatestBlock()]))\n}\n\nconst scheduleTick = async ctx => {\n  return setTimeout(\n    () => ctx.sendSelf(TICK),\n    await config().get(\"fcl.eventPollRate\", RATE)\n  )\n}\n\nconst HANDLERS = {\n  [TICK]: async ctx => {\n    if (!ctx.hasSubs()) return\n    let hwm = ctx.get(\"hwm\")\n    if (hwm == null) {\n      ctx.put(\"hwm\", await currentBlock())\n      ctx.put(\"tick\", await scheduleTick(ctx))\n    } else {\n      let next = await currentBlock()\n      ctx.put(\"hwm\", next)\n      const resp = await send([\n        getEvents(ctx.self(), hwm.height, next.height - 1),\n      ])\n      const data = await decode(resp)\n      for (let d of data) ctx.broadcast(UPDATED, d.data)\n      ctx.put(\"tick\", await scheduleTick(ctx))\n    }\n  },\n  [SUBSCRIBE]: async (ctx, letter) => {\n    if (!ctx.hasSubs()) {\n      ctx.put(\"tick\", await scheduleTick(ctx))\n    }\n    ctx.subscribe(letter.from)\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n    if (!ctx.hasSubs()) {\n      clearTimeout(ctx.get(\"tick\"))\n      ctx.delete(\"tick\")\n      ctx.delete(\"hwm\")\n    }\n  },\n}\n\nconst spawnEvents = key => spawn(HANDLERS, key)\n\nexport function events(key) {\n  return {\n    subscribe: callback => subscriber(key, spawnEvents, callback),\n  }\n}\n","export function sansPrefix(address) {\n  if (address == null) return null\n  return address.replace(/^0x/, \"\")\n}\n\nexport function withPrefix(address) {\n  if (address == null) return null\n  return \"0x\" + sansPrefix(address)\n}\n","const FRAME_ID = \"FCL_IFRAME\"\n\nexport function renderFrame(src) {\n  if (document.getElementById(FRAME_ID)) return\n\n  const $frame = document.createElement(\"iframe\")\n  $frame.src = src\n  $frame.id = FRAME_ID\n  $frame.allow = \"usb\"\n  $frame.style.position = \"fixed\"\n  $frame.style.top = \"0px\"\n  $frame.style.right = \"0px\"\n  $frame.style.left = \"0px\"\n  $frame.style.bottom = \"0px\"\n  $frame.style.height = \"100vh\"\n  $frame.style.width = \"100vw\"\n  $frame.style.display = \"block\"\n  $frame.style.background = \"rgba(0,0,0,0.25)\"\n  $frame.frameBorder = \"0\"\n  $frame.style.boxSizing = \"border-box\"\n  $frame.style.border = \"1px solid white\"\n  document.body.append($frame)\n\n  const unmount = () => {\n    if (document.getElementById(FRAME_ID)) {\n      document.getElementById(FRAME_ID).remove()\n    }\n  }\n\n  return [$frame, unmount]\n}\n","export function urlFromService(service, includeParams = true) {\n  const url = new URL(service.endpoint)\n  if (includeParams) {\n    for (let [key, value] of Object.entries(service.params || {})) {\n      url.searchParams.append(key, value)\n    }\n  }\n  return url\n}\n","import {urlFromService} from \"./url-from-service\"\nimport {renderFrame} from \"./render-frame\"\n\nexport function renderAuthzFrame(service) {\n  var url = urlFromService(service)\n  return renderFrame(url.href)\n}\n","import {urlFromService} from \"./url-from-service\"\n\nconst METHODS = {\n  \"HTTP/GET\": \"GET\",\n  \"HTTP/POST\": \"POST\",\n}\n\nexport const pollForAuthzUpdates = service =>\n  new Promise(async (resolve, reject) => {\n    const resp = await fetch(urlFromService(service), {\n      method: METHODS[service.method],\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    }).then(d => d.json())\n\n    if (resp.status === \"APPROVED\") {\n      resolve(resp.compositeSignature)\n    } else if (resp.status === \"DECLINED\") {\n      reject({status: resp.status, reason: resp.reason})\n    } else {\n      setTimeout(() => {\n        resolve(pollForAuthzUpdates(resp.authorizationUpdates))\n      }, 500)\n    }\n  })\n","const label = (key, full) => (full == null ? `'${key}'` : `'${key}' (${full})`)\n\nconst missing = (key, full) =>\n  `Missing ${label(key, full)} in Composite Signature.`\nconst noMatch = (key, full) =>\n  `${label(\n    key,\n    full\n  )} in Composit Signature did not match the requested ${key}.`\n\nexport function validateCompositeSignature(compSig, authz) {\n  try {\n    if (compSig.addr == null) throw new Error(missing(\"addr\", \"Address\"))\n    if (compSig.keyId == null) throw new Error(missing(\"keyId\"))\n    if (compSig.signature == null) throw new Error(missing(\"signature\"))\n    if (compSig.addr !== authz.addr) throw new Error(noMatch(\"addr\", \"Address\"))\n    if (compSig.keyId !== authz.keyId) throw new Error(noMatch(\"keyId\"))\n    return compSig\n  } catch (error) {\n    console.error(error, \"\\n\\n\", {\n      \"Composite Signature\": compSig,\n      \"Authz Service\": authz,\n    })\n    throw new Error(\n      `Composite Signature from Wallet Provider failed Validation/Sanitation.\\nReason: ${error.message}`\n    )\n  }\n}\n","// Inspired by: https://github.com/lukeed/uid/blob/master/src/index.js , thank you Luke! https://github.com/lukeed\n\nvar HEX = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\"\nvar T = HEX.length\n\nexport function uid() {\n  var str = \"\",\n    num = 32\n  while (num--) str += HEX[(Math.random() * T) | 0]\n  return str\n}\n","import {urlFromService} from \"./url-from-service\"\nimport {renderAuthzFrame} from \"./render-authz-frame\"\nimport {pollForAuthzUpdates} from \"./poll-for-authz-updates\"\nimport {validateCompositeSignature} from \"./validate-composite-signature\"\nimport {uid} from \"./uid\"\n\nconst STRATEGIES = {\n  \"HTTP/POST\": execHttpPost,\n  \"IFRAME/RPC\": execIframeRPC,\n}\n\nexport async function execAuthzService(authz, signable) {\n  const compSig = await STRATEGIES[authz.method](authz, signable)\n  if (compSig.sig == null) compSig.sig = compSig.signature\n  if (compSig.signature == null) compSig.signature = compSig.sig\n  validateCompositeSignature(compSig, authz)\n  return compSig\n}\n\nasync function execHttpPost(authz, signable) {\n  var unrender = () => {}\n  var result = null\n  try {\n    const resp = await fetch(urlFromService(authz), {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: signable ? JSON.stringify(signable) : undefined,\n    }).then(d => d.json())\n\n    if (resp.local && resp.local.length > 0) {\n      const [_, unmount] = renderAuthzFrame(resp.local[0])\n      unrender = unmount\n    }\n\n    result = await pollForAuthzUpdates(resp.authorizationUpdates)\n  } catch (error) {\n    unrender()\n    trouble(authz, signable, error)\n    throw error\n  } finally {\n    unrender()\n    return result\n  }\n}\n\nasync function execIframeRPC(authz, signable) {\n  return new Promise((resolve, reject) => {\n    try {\n      const id = uid()\n      const [$frame, unmount] = renderAuthzFrame(authz)\n      setTimeout(() => {\n        $frame.contentWindow.postMessage(\n          JSON.parse(\n            JSON.stringify({\n              jsonrpc: \"2.0\",\n              id,\n              method: \"fcl:sign\",\n              params: [signable, authz.params],\n            })\n          ),\n          \"*\"\n        )\n      }, 500)\n\n      const replyFn = async ({data}) => {\n        if (typeof data !== \"object\") return\n        if (data.jsonrpc !== \"2.0\") return\n        if (data.id !== id) return\n\n        const result = data.result\n\n        if (result.status === \"APPROVED\") {\n          window.removeEventListener(\"message\", replyFn)\n          unmount()\n          resolve(result.compositeSignature)\n        } else if (result.status === \"DECLINED\") {\n          window.removeEventListener(\"message\", replyFn)\n          unmount()\n          reject({status: result.status, reason: result.reason})\n        } else {\n          window.removeEventListener(\"message\", replyFn)\n          unmount()\n          reject({\n            status: \"DECLINED\",\n            reason: \"Status was neither APPROVED nor DECLINED\",\n          })\n        }\n      }\n\n      window.addEventListener(\"message\", replyFn)\n    } catch (error) {\n      trouble(authz, signable, error)\n      reject({status: \"DECLINED\", reason: \"Trouble talking to Wallet Provider\"})\n    }\n  })\n}\n\nfunction trouble(authz, signable, error) {\n  console.error(\n    `[${authz.method}] Trouble talking to Wallet Provider`,\n    \"\\n\\n\",\n    {authz, signable},\n    error\n  )\n}\n","import \"../default-config\"\nimport {getAccount} from \"@onflow/sdk\"\nimport {Identity} from \"@onflow/types\"\nimport {config} from \"@onflow/config\"\nimport {spawn, send, INIT, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {send as fclSend} from \"../send\"\nimport {renderAuthnFrame} from \"./render-authn-frame\"\nimport {fetchServices} from \"./fetch-services\"\nimport {mergeServices} from \"./merge-services\"\nimport {serviceOfType} from \"./service-of-type\"\nimport {execAuthzService} from \"./exec-authz-service\"\nimport {validateCompositeSignature} from \"./validate-composite-signature\"\n\nconst NAME = \"CURRENT_USER\"\nconst UPDATED = \"CURRENT_USER/UPDATED\"\nconst SNAPSHOT = \"SNAPSHOT\"\nconst SET_CURRENT_USER = \"SET_CURRENT_USER\"\nconst DEL_CURRENT_USER = \"DEL_CURRENT_USER\"\nconst GET_AS_PARAM = \"GET_AS_PARAM\"\n\nconst CHALLENGE_RESPONSE_EVENT = \"FCL::CHALLENGE::RESPONSE\"\n\nconst DATA = `{\n  \"VERSION\": \"0.2.0\",\n  \"addr\":null,\n  \"cid\":null,\n  \"loggedIn\":null,\n  \"services\":[]\n}`\n\nconst coldStorage = {\n  get: async () => {\n    const fallback = JSON.parse(DATA)\n    const stored = JSON.parse(localStorage.getItem(NAME))\n    if (stored != null && fallback.VERSION !== stored.VERSION) {\n      localStorage.removeItem(NAME)\n      return fallback\n    }\n    return stored || fallback\n  },\n  put: async data => {\n    localStorage.setItem(NAME, JSON.stringify(data))\n    return data\n  },\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    ctx.merge(await coldStorage.get())\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, ctx.all())\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply(ctx.all())\n  },\n  [SET_CURRENT_USER]: async (ctx, letter, data) => {\n    ctx.merge(data)\n    coldStorage.put(ctx.all())\n    ctx.broadcast(UPDATED, ctx.all())\n  },\n  [DEL_CURRENT_USER]: async (ctx, letter) => {\n    ctx.merge(JSON.parse(DATA))\n    coldStorage.put(ctx.all())\n    ctx.broadcast(UPDATED, ctx.all())\n  },\n  [GET_AS_PARAM]: async (ctx, letter, {key}) => {\n    letter.reply({key, value: ctx.get(\"addr\", null), xform: Identity})\n  },\n}\n\nconst identity = v => v\nconst spawnCurrentUser = () => spawn(HANDLERS, NAME)\n\nasync function authenticate() {\n  return new Promise(async resolve => {\n    spawnCurrentUser()\n    const user = await snapshot()\n    if (user.loggedIn) return resolve(user)\n\n    const [$frame, unrender] = renderAuthnFrame({\n      handshake: await config().get(\"challenge.handshake\"),\n      l6n: window.location.origin,\n    })\n\n    const replyFn = async ({data}) => {\n      if (data.type !== CHALLENGE_RESPONSE_EVENT) return\n      unrender()\n      window.removeEventListener(\"message\", replyFn)\n\n      const msg = {\n        addr: data.addr,\n        cid: `did:fcl:${data.addr}`,\n        loggedIn: true,\n        services: mergeServices(\n          data.services || [],\n          await fetchServices(data.hks, data.code)\n        ),\n      }\n\n      send(NAME, SET_CURRENT_USER, msg)\n      resolve(await snapshot())\n    }\n\n    window.addEventListener(\"message\", replyFn)\n  })\n}\n\nfunction unauthenticate() {\n  spawnCurrentUser()\n  send(NAME, DEL_CURRENT_USER)\n}\n\nasync function authorization(account) {\n  spawnCurrentUser()\n  const user = await authenticate()\n  const authz = serviceOfType(user.services, \"authz\")\n\n  let sequenceNum\n  if (account.role.proposer) {\n    const acct = await info()\n    const key = acct.keys.find(key => key.index === authz.keyId)\n    sequenceNum = key.sequenceNumber\n  }\n\n  const signingFunction = async signable => execAuthzService(authz, signable)\n\n  return {\n    ...account,\n    addr: authz.addr,\n    keyId: authz.keyId,\n    sequenceNum,\n    signature: account.signature || null,\n    signingFunction,\n    resolve: null,\n    roles: account.roles,\n  }\n}\n\nfunction param(key) {\n  return async function innerParam() {\n    spawnCurrentUser()\n    await authenticate()\n    return send(NAME, GET_AS_PARAM, {key}, {expectReply: true, timeout: 10})\n  }\n}\n\nfunction subscribe(callback) {\n  spawnCurrentUser()\n  const EXIT = \"@EXIT\"\n  const self = spawn(async ctx => {\n    ctx.send(NAME, SUBSCRIBE)\n    while (1) {\n      const letter = await ctx.receive()\n      if (letter.tag === EXIT) {\n        ctx.send(NAME, UNSUBSCRIBE)\n        return\n      }\n      callback(letter.data)\n    }\n  })\n  return () => send(self, EXIT)\n}\n\nfunction snapshot() {\n  spawnCurrentUser()\n  return send(NAME, SNAPSHOT, null, {expectReply: true, timeout: 0})\n}\n\nasync function info() {\n  spawnCurrentUser()\n  const {addr} = await snapshot()\n  if (addr == null) throw new Error(\"No Flow Address for Current User\")\n  const {account} = await fclSend([getAccount(addr)])\n  return account\n}\n\nexport const currentUser = () => {\n  return {\n    authenticate,\n    unauthenticate,\n    authorization,\n    param,\n    subscribe,\n    snapshot,\n  }\n}\n","export function serviceOfType(services = [], type) {\n  return services.find(service => service.type === type)\n}\n","import {renderFrame} from \"./render-frame\"\n\nexport function renderAuthnFrame({handshake, l6n}) {\n  var url = new URL(handshake)\n  url.searchParams.append(\"l6n\", l6n)\n  return renderFrame(url.href)\n}\n","export async function fetchServices(servicesURL, code) {\n  if (servicesURL == null || code == null) return []\n\n  const url = new URL(servicesURL)\n  url.searchParams.append(\"code\", code)\n\n  const resp = await fetch(url, {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n  }).then(d => d.json())\n\n  if (Array.isArray(resp)) return resp\n\n  // Backwards compatibility for First-Gen Wallet Providers\n  const services = []\n\n  // Convert authorizations into authz services\n  if (Array.isArray(resp.authorizations)) {\n    for (let service of resp.authorizations) {\n      services.push({\n        type: \"authz\",\n        keyId: resp.keyId,\n        ...service,\n      })\n    }\n  }\n\n  // Convert Provider info into an authn service\n  if (resp.provider != null) {\n    services.push({\n      type: \"authn\",\n      id: \"wallet-provider#authn\",\n      ...resp.provider,\n    })\n  }\n\n  return services\n}\n","export function mergeServices(sx1 = [], sx2 = []) {\n  // TODO: Make this smarter\n  return [...sx1, ...sx2]\n}\n","import \"./default-config\"\nexport {config} from \"@onflow/config\"\nexport {send} from \"./send\"\nexport {serialize} from \"./serialize\"\nexport {decode} from \"./decode\"\nexport {transaction as tx} from \"./transaction\"\nexport {resolve} from \"./resolve\"\nexport {events} from \"./events\"\nexport {withPrefix, sansPrefix} from \"./address\"\n\nimport {currentUser} from \"./current-user\"\nexport {currentUser}\n\nexport const authenticate = () => currentUser().authenticate()\nexport const unauthenticate = () => currentUser().unauthenticate()\n\n// proxy sdk\nexport {isOk, isBad, why, cadence, cdc} from \"@onflow/sdk\"\nexport {\n  build,\n  pipe,\n  transaction,\n  script,\n  ping,\n  getAccount,\n  getEvents,\n  getLatestBlock,\n  getBlockByHeight,\n  getBlockById,\n  getTransactionStatus,\n} from \"@onflow/sdk\"\nexport {\n  authorizations,\n  authorization,\n  args,\n  arg,\n  params,\n  param,\n  proposer,\n  payer,\n  limit,\n  ref,\n} from \"@onflow/sdk\"\n\nexport const VERSION = \"0.0.56\"\n"],"names":["config","put","resolve","ix","get","sdkResolve","resolveRefBlockId","node","resolveParams","resolveArguments","resolveAccounts","resolveSignatures","resolveValidators","send","args","opts","Array","isArray","build","sdkSend","serialize","JSON","stringify","decode","response","where","decodersFromConfig","decoders","Object","fromEntries","entries","map","pattern","xform","replace","decodeResponse","fetchTxStatus","transactionId","fclSend","getTransactionStatus","isSealed","tx","status","isExecuted","isFinalized","HANDLERS","INIT","ctx","self","setTimeout","sendSelf","merge","SUBSCRIBE","letter","subscribe","from","UPDATED","all","UNSUBSCRIBE","unsubscribe","SNAPSHOT","reply","cur","next","broadcast","scoped","Error","spawnTransaction","spawn","transaction","callback","subscriber","once","predicate","suppress","Promise","reject","unsub","txStatus","statusCode","errorMessage","snapshot","snapshoter","onceFinalized","onceExecuted","onceSealed","isUnknown","isPending","isExpired","currentBlock","getLatestBlock","scheduleTick","hasSubs","hwm","_put4","_put2","getEvents","height","resp","data","_put3","_put6","clearTimeout","spawnEvents","key","events","sansPrefix","address","withPrefix","renderFrame","src","document","getElementById","$frame","createElement","id","allow","style","position","top","right","left","bottom","width","display","background","frameBorder","boxSizing","border","body","append","remove","urlFromService","service","includeParams","url","URL","endpoint","params","searchParams","renderAuthzFrame","href","METHODS","HTTP/GET","HTTP/POST","label","full","missing","noMatch","HEX","T","length","STRATEGIES","authz","signable","unrender","result","finalizer","e","then","recover","fetch","method","headers","Content-Type","undefined","d","json","local","pollForAuthzUpdates","compositeSignature","reason","authorizationUpdates","error","trouble","IFRAME/RPC","str","num","Math","random","uid","unmount","contentWindow","postMessage","parse","jsonrpc","window","addEventListener","replyFn","removeEventListener","console","pact","state","value","s","o","_settle","bind","v","observer","authorization","account","spawnCurrentUser","authenticate","user","addr","keyId","sequenceNum","signature","signingFunction","compSig","sig","Composite Signature","Authz Service","message","validateCompositeSignature","execAuthzService","roles","services","find","type","role","proposer","getAccount","info","acct","keys","index","sequenceNumber","_Pact","prototype","onFulfilled","onRejected","this","_this","_isSettledPact","thenable","loggedIn","l6n","handshake","location","origin","CHALLENGE_RESPONSE_EVENT","servicesURL","code","authorizations","push","provider","fetchServices","hks","sx1","sx2","msg","cid","NAME","SET_CURRENT_USER","DATA","coldStorage","localStorage","setItem","fallback","stored","getItem","VERSION","removeItem","_merge2","Identity","unauthenticate","param","expectReply","timeout","test","update","stage","shouldContinue","_resumeAfterTest","_resumeAfterBody","updateValue","receive","tag","_exit2","currentUser"],"mappings":"uyBAEAA,IACGC,IAAI,iBAAkB,yBACtBA,IAAI,sBAAuB,sCCQjBC,QAAAA,WAAgBC,8BAEMH,IAASI,IAAI,oCAD9C,OAAOC,EAAWF,EAAI,CACpBG,EAAkB,CAACC,SAEnBC,EACAC,EACAC,EACAC,EACAC,MARgB,oCCRPC,WAAcC,EAAWC,YAAXD,IAAAA,EAAO,aAAIC,IAAAA,EAAO,0BAAO,OAClDA,EAAKR,OACDS,MAAMC,QAAQH,KAAOA,EAAOI,EAAMJ,oBACjBZ,EAAQY,qBAA7B,OAAOK,IAA6BJ,QAFxBA,EAAKR,mDAAeP,IAASI,IAAI,4BAD9B,oCCDJgB,WAAmBN,YAAAA,IAAAA,EAAO,gDAETZ,EAAQY,SAA7BO,KAAKC,yBADZ,GAAIN,MAAMC,QAAQH,0BAAoBI,EAAMJ,qBAAnBA,yDADL,oCCATS,WAAeC,8BACOxB,IAASyB,MAAM,6BAA1CC,GACN,IAAMC,EAAWC,OAAOC,YACtBD,OAAOE,QAAQJ,GAAoBK,IAAI,gBAAEC,OAASC,OAEhD,MAAO,CADPD,MAAcA,EAAQE,QAAQ,aAAc,SAC3BD,MAGrB,OAAOE,EAAeX,EAAUG,KARf,oCCiBbS,WAAsBC,8BACHC,EAAQ,CAACC,EAAqBF,WAC9Cd,GAFU,oCAMbiB,EAAW,SAAAC,UAAMA,EAAGC,QAAU,GAC9BC,EAAa,SAAAF,UAAMA,EAAGC,QAAU,GAChCE,EAAc,SAAAH,UAAMA,EAAGC,QAAU,GAQjCG,UACHC,YAAaC,8BACKX,EAAcW,EAAIC,uBAA7BP,GACDD,EAASC,IAAKQ,WAAW,kBAAMF,EAAIG,SArB/B,SADA,MAuBTH,EAAII,MAAMV,KAJA,sCAMXW,GAAY,SAACL,EAAKM,GACjBN,EAAIO,UAAUD,EAAOE,MACrBR,EAAIlC,KAAKwC,EAAOE,KAAMC,EAAST,EAAIU,UAEpCC,GAAc,SAACX,EAAKM,GACnBN,EAAIY,YAAYN,EAAOE,SAExBK,YAAkBb,EAAKM,OAAW,OACjCA,EAAOQ,MAAMd,EAAIU,yBAdP,sCAAA,cAgBEV,8BACKX,EAAcW,EAAIC,uBAA7BP,GArBK,IAACqB,EAAKC,EAsBZvB,EAASC,IAAKQ,WAAW,kBAAMF,EAAIG,SApC/B,SADA,MAeGY,EAuBDf,EAAIU,MAvBEM,EAuBKtB,EAtBjBpB,KAAKC,UAAUwC,KAASzC,KAAKC,UAAUyC,IAsBjBhB,EAAIiB,UAAUR,EAASf,GAClDM,EAAII,MAAMV,KApBA,uCAwBRwB,EAAS,SAAA5B,GAGb,GAF6B,iBAAlBA,IACTA,EAAgBA,EAAcA,eACX,MAAjBA,EAAuB,UAAU6B,MAAM,0BAC3C,OAAO7B,GAGH8B,EAAmB,SAAA9B,GACvB,OAAO+B,EAAMvB,EAAUoB,EAAO5B,cAGhBgC,EAAYhC,GAK1B,SAASiB,EAAUgB,GACjB,OAAOC,EAAWN,EAAO5B,GAAgB8B,EAAkBG,GAG7D,SAASE,EAAKC,GACZ,gBAA0B1D,YAAAA,IAAAA,EAAO,IAC/B,IAAM2D,EAAW3D,EAAK2D,WAAY,EAClC,WAAWC,QAAQ,SAACzE,EAAS0E,GAC3B,IAAMC,EAAQvB,EAAU,SAAAwB,GAClBA,EAASC,aAAeL,GAC1BE,EAAOE,EAASE,cAChBH,KACSJ,EAAUK,KACnB5E,EAAQ4E,GACRD,UAOV,MAAO,CACLI,SA1BF,WACE,OAAOC,EAAW7C,EAAe8B,IA0BjCb,UAAAA,EACA6B,cAAeX,EAAK5B,GACpBwC,aAAcZ,EAAK7B,GACnB0C,WAAYb,EAAKhC,+9BAIrB6B,EAAYiB,UA5EM,SAAA7C,UAAMA,EAAGC,QAAU,GA6ErC2B,EAAYkB,UA9EM,SAAA9C,UAAMA,EAAGC,QAAU,GA+ErC2B,EAAYzB,YAAcA,EAC1ByB,EAAY1B,WAAaA,EACzB0B,EAAY7B,SAAWA,EACvB6B,EAAYmB,UAtFM,SAAA/C,UAAoB,IAAdA,EAAGC,QCzB3B,IAUM+C,wCACgB5E,EAAK,CAAC6E,YAAnBnE,GADS,oCAIZoE,WAAqB5C,aAClBE,kCAECjD,IAASI,IAAI,oBAXV,uBASX,SACE,kBAAM2C,EAAIG,SARD,cAMK,oCAOZL,UAAQ,cACEE,OACZ,IAAKA,EAAI6C,UAAW,yBACpB,IAAIC,EAAM9C,EAAI3C,IAAI,uBACP,MAAPyF,SACF9C,EAAI9C,2BAAiBwF,sBAArBK,OAAA/C,EAAQ,SAJS,MAKjBA,EAAI9C,2BAAkB0F,EAAa5C,qBAAnCgD,OAAAhD,EAAQ,qCAES0C,mBAAb1B,GAPa,OAQjBhB,EAAI9C,IAAI,MAAO8D,mBACIlD,EAAK,CACtBmF,EAAUjD,EAAIC,OAAQ6C,EAAII,OAAQlC,EAAKkC,OAAS,oBAD5CC,0BAGa3E,EAAO2E,kBAApBC,GACN,cAAcA,kBAAMpD,EAAIiB,UA5Bd,kBA4BmCmC,MAb5B,MAcjBpD,EAAI9C,2BAAkB0F,EAAa5C,qBAAnCqD,OAAArD,EAAQ,mFAfA,sCAkBXK,YAAmBL,EAAKM,wBAIvBN,EAAIO,UAAUD,EAAOE,wBAHhBR,EAAI6C,iBACP7C,EAAI9C,2BAAkB0F,EAAa5C,qBAAnCsD,OAAAtD,EAAQ,gEApBA,sCAwBXW,GAAc,SAACX,EAAKM,GACnBN,EAAIY,YAAYN,EAAOE,MAClBR,EAAI6C,YACPU,aAAavD,EAAI3C,IAAI,SACrB2C,SAAW,QACXA,SAAW,YAKXwD,EAAc,SAAAC,UAAOpC,EAAMvB,EAAU2D,aAE3BC,EAAOD,GACrB,MAAO,CACLlD,UAAW,SAAAgB,UAAYC,EAAWiC,EAAKD,EAAajC,cC3DxCoC,EAAWC,GACzB,OAAe,MAAXA,OACGA,EAAQzE,QAAQ,MAAO,aAGhB0E,EAAWD,GACzB,OAAe,MAAXA,OACG,KAAOD,EAAWC,GCL3B,SAAgBE,EAAYC,GAC1B,IAAIC,SAASC,eAHE,cAGf,CAEA,IAAMC,EAASF,SAASG,cAAc,UAwBtC,OAvBAD,EAAOH,IAAMA,EACbG,EAAOE,GAPQ,aAQfF,EAAOG,MAAQ,MACfH,EAAOI,MAAMC,SAAW,QACxBL,EAAOI,MAAME,IAAM,MACnBN,EAAOI,MAAMG,MAAQ,MACrBP,EAAOI,MAAMI,KAAO,MACpBR,EAAOI,MAAMK,OAAS,MACtBT,EAAOI,MAAMpB,OAAS,QACtBgB,EAAOI,MAAMM,MAAQ,QACrBV,EAAOI,MAAMO,QAAU,QACvBX,EAAOI,MAAMQ,WAAa,mBAC1BZ,EAAOa,YAAc,IACrBb,EAAOI,MAAMU,UAAY,aACzBd,EAAOI,MAAMW,OAAS,kBACtBjB,SAASkB,KAAKC,OAAOjB,GAQd,CAACA,EANQ,WACVF,SAASC,eAxBA,eAyBXD,SAASC,eAzBE,cAyBuBmB,qBCzBxBC,EAAeC,EAASC,YAAAA,IAAAA,GAAgB,GACtD,IAAMC,EAAM,IAAIC,IAAIH,EAAQI,UAC5B,GAAIH,EACF,cAAyB1G,OAAOE,QAAQuG,EAAQK,QAAU,mBAAK,YAC7DH,EAAII,aAAaT,kBAGrB,OAAOK,WCJOK,EAAiBP,GAE/B,OAAOxB,EADGuB,EAAeC,GACFQ,MCHzB,MAAMC,EAAU,CACdC,WAAY,MACZC,YAAa,QCJTC,GAAQ,SAACzC,EAAK0C,UAAkB,MAARA,MAAmB1C,UAAaA,QAAS0C,OAEjEC,GAAU,SAAC3C,EAAK0C,oBACTD,GAAMzC,EAAK0C,+BAClBE,GAAU,SAAC5C,EAAK0C,UACjBD,GACDzC,EACA0C,yDACqD1C,OCNrD6C,GAAM,iEACNC,GAAID,GAAIE,OCGNC,GAAa,CACjBR,qBAY0BS,EAAOC,OACjC,IAAIC,EAAW,aACXC,EAAS,KAF8B,uBAyjBtC,SAAkB3B,EAAM4B,GAC9B,IACC,IAAID,EAAS3B,IACZ,MAAO6B,GACR,OAAOD,IAER,OAAID,GAAUA,EAAOG,KACbH,EAAOG,KAAKF,EAAWA,GAExBA,gCAnCe5B,EAAM+B,GAC5B,IACC,IAAIJ,EAAS3B,IACZ,MAAM6B,GACP,OAAOE,EAAQF,GAEhB,OAAIF,GAAUA,EAAOG,KACbH,EAAOG,UAAK,EAAQC,GAErBJ,qCApiBeK,MAAM7B,EAAeqB,GAAQ,CAC9CS,OAAQ,OACRC,QAAS,CACPC,eAAgB,oBAElBnC,KAAMyB,EAAWrI,KAAKC,UAAUoI,QAAYW,IAC3CN,KAAK,SAAAO,UAAKA,EAAEC,wBANTrE,GAQN,GAAIA,EAAKsE,OAAStE,EAAKsE,MAAMjB,OAAS,EAAG,OAClBX,EAAiB1C,EAAKsE,MAAM,IACjDb,OAXA,uBHf6B,SAAtBc,EAAsBpC,cAC7B1D,iBAAezE,EAAS0E,8BACPqF,MAAM7B,EAAeC,GAAU,CAChD6B,OAAQpB,EAAQT,EAAQ6B,QACxBC,QAAS,CACPC,eAAgB,sBAEjBL,KAAK,SAAAO,UAAKA,EAAEC,wBALTrE,GAOc,aAAhBA,EAAKxD,OACPxC,EAAQgG,EAAKwE,oBACY,aAAhBxE,EAAKxD,OACdkC,EAAO,CAAClC,OAAQwD,EAAKxD,OAAQiI,OAAQzE,EAAKyE,SAE1C1H,WAAW,WACT/C,EAAQuK,EAAoBvE,EAAK0E,wBAChC,OAfP,qCG4BiBH,CAAoBvE,EAAK0E,wCAAxChB,kBACOiB,GAGP,MAFAlB,IACAmB,GAAQrB,EAAOC,EAAUmB,GACnBA,gBAGN,OADAlB,IACOC,yCAnCTmB,sBAuC2BtB,EAAOC,OAClC,uBAAO,IAAI/E,QAAQ,SAACzE,EAAS0E,GAC3B,IACE,IAAMuC,ED7CZ,WAGE,IAFA,IAAI6D,EAAM,GACRC,EAAM,GACDA,KAAOD,GAAO3B,GAAK6B,KAAKC,SAAW7B,GAAK,GAC/C,OAAO0B,ECyCQI,KACexC,EAAiBa,GAApCxC,OAAQoE,OACfpI,WAAW,WACTgE,EAAOqE,cAAcC,YACnBlK,KAAKmK,MACHnK,KAAKC,UAAU,CACbmK,QAAS,MACTtE,GAAAA,EACA+C,OAAQ,WACRxB,OAAQ,CAACgB,EAAUD,EAAMf,WAG7B,MAED,KA2BHgD,OAAOC,iBAAiB,mBAzBlBC,SAAkBzF,IAAAA,SACtB,GAAoB,iBAATA,EAAmB,yBAC9B,GAAqB,QAAjBA,EAAKsF,QAAmB,yBAC5B,GAAItF,EAAKgB,KAAOA,EAAI,yBAEpB,IAAMyC,EAASzD,EAAKyD,OALY,MAOV,aAAlBA,EAAOlH,QACTgJ,OAAOG,oBAAoB,UAAWD,GACtCP,IACAnL,EAAQ0J,EAAOc,qBACY,aAAlBd,EAAOlH,QAChBgJ,OAAOG,oBAAoB,UAAWD,GACtCP,IACAzG,EAAO,CAAClC,OAAQkH,EAAOlH,OAAQiI,OAAQf,EAAOe,WAE9Ce,OAAOG,oBAAoB,UAAWD,GACtCP,IACAzG,EAAO,CACLlC,OAAQ,WACRiI,OAAQ,gEApBD,qCA0Bb,MAAOE,GACPC,GAAQrB,EAAOC,EAAUmB,GACzBjG,EAAO,CAAClC,OAAQ,WAAYiI,OAAQ,gFAK1C,SAASG,GAAQrB,EAAOC,EAAUmB,GAChCiB,QAAQjB,UACFpB,EAAMS,8CACV,OACA,CAACT,MAAAA,EAAOC,SAAAA,GACRmB,GCjEG,YAAiBkB,EAAMC,EAAOC,GACpC,IAAKF,EAAKG,EAAG,CACZ,GAAID,gBAAwB,CAC3B,IAAIA,EAAMC,EAOT,YADAD,EAAME,EAAIC,GAAQC,KAAK,KAAMN,EAAMC,IALvB,EAARA,IACHA,EAAQC,EAAMC,GAEfD,EAAQA,EAAMK,EAMhB,GAAIL,GAASA,EAAMlC,KAElB,YADAkC,EAAMlC,KAAKqC,GAAQC,KAAK,KAAMN,EAAMC,GAAQI,GAAQC,KAAK,KAAMN,EAAM,IAGtEA,EAAKG,EAAIF,EACTD,EAAKO,EAAIL,EACT,IAAMM,EAAWR,EAAKI,EAClBI,GACHA,EAASR,QAyDGS,YAAcC,OAAS,OACpCC,qBACmBC,oBAAbC,gBAYN,YACKH,GACHI,KAAMpD,EAAMoD,KACZC,MAAOrD,EAAMqD,MACbC,YAAAA,EACAC,UAAWP,EAAQO,WAAa,KAChCC,yBAR4BvD,uCDtHOD,EAAOC,8BACtBF,GAAWC,EAAMS,QAAQT,EAAOC,kBAAhDwD,GAIN,OAHmB,MAAfA,EAAQC,MAAaD,EAAQC,IAAMD,EAAQF,WACtB,MAArBE,EAAQF,YAAmBE,EAAQF,UAAYE,EAAQC,KFJ7D,SAA2CD,EAASzD,GAClD,IACE,GAAoB,MAAhByD,EAAQL,KAAc,UAAU3I,MAAMiF,GAAQ,OAAQ,YAC1D,GAAqB,MAAjB+D,EAAQJ,MAAe,UAAU5I,MAAMiF,GAAQ,UACnD,GAAyB,MAArB+D,EAAQF,UAAmB,UAAU9I,MAAMiF,GAAQ,cACvD,GAAI+D,EAAQL,OAASpD,EAAMoD,KAAM,UAAU3I,MAAMkF,GAAQ,OAAQ,YACjE,GAAI8D,EAAQJ,QAAUrD,EAAMqD,MAAO,UAAU5I,MAAMkF,GAAQ,UAE3D,MAAOyB,GAKP,MAJAiB,QAAQjB,MAAMA,EAAO,OAAQ,CAC3BuC,sBAAuBF,EACvBG,gBAAiB5D,QAETvF,yFAC2E2G,EAAMyC,UET7FC,CAA2BL,EAASzD,GAC7ByD,IALT,mCCsH4CM,CAAiB/D,EAAOC,wCAShExJ,QAAS,KACTuN,MAAOhB,EAAQgB,QAnBjB,ICxH4BC,ED0HxBX,EAFEtD,aCxHsBiE,EDwHAd,EAAKc,YCxHLA,EAAW,IAChCA,EAASC,KAAK,SAAAtF,SDuHsB,UCvHXA,EAAQuF,wBD0HpCnB,EAAQoB,KAAKC,+CAkDG,OACpBpB,qBACqBzH,2BAAd4H,IAAAA,KACP,GAAY,MAARA,EAAc,UAAU3I,MAAM,oCAHd,uBAII5B,EAAQ,CAACyL,EAAWlB,uBAC5C,SADOJ,+CArDcuB,kBAAbC,GACN,IAAMzH,EAAMyH,EAAKC,KAAKP,KAAK,SAAAnH,UAAOA,EAAI2H,QAAU1E,EAAMqD,QACtDC,EAAcvG,EAAI4H,4FA7Ha,WAClC,cAiCA,OAhCAC,EAAMC,UAAUvE,KAAO,SAASwE,EAAaC,GAC5C,IAAM5E,EAAS,MACToC,EAAQyC,KAAKvC,EACnB,GAAIF,EAAO,CACV,IAAM1H,EAAmB,EAAR0H,EAAYuC,EAAcC,EAC3C,GAAIlK,EAAU,CACb,IACC8H,GAAQxC,EAAQ,EAAGtF,EAASmK,KAAKnC,IAChC,MAAOxC,GACRsC,GAAQxC,EAAQ,EAAGE,GAEpB,OAAOF,EAEP,YAiBF,OAdA6E,KAAKtC,EAAI,SAASuC,GACjB,IACC,IAAMzC,EAAQyC,EAAMpC,EACN,EAAVoC,EAAMxC,EACTE,GAAQxC,EAAQ,EAAG2E,EAAcA,EAAYtC,GAASA,GAC5CuC,EACVpC,GAAQxC,EAAQ,EAAG4E,EAAWvC,IAE9BG,GAAQxC,EAAQ,EAAGqC,GAEnB,MAAOnC,GACRsC,GAAQxC,EAAQ,EAAGE,KAGdF,KAhC0B,GAgE5B,SAAS+E,GAAeC,GAC9B,OAAOA,aAAoBP,IAAsB,EAAbO,EAAS1C,MAY/BS,kBACb,uBAAO,IAAIhI,iBAAczE,OAAW,OAClCwM,qBACmBzH,oBAAb2H,UACFA,EAAKiC,SAAiB3O,EAAQ0M,mBAGf5M,IAASI,IAAI,+CEnFS0O,EACvCvG,EFiFaoB,GElF0BmF,KFkFG,CAC1CC,YACAD,IAAKpD,OAAOsD,SAASC,SEpFkBH,KACvCvG,EAAM,IAAIC,MADkBuG,YAE5BpG,aAAaT,OAAO,MAAO4G,GACxBjI,EAAY0B,EAAIM,UFuGrB6C,OAAOC,iBAAiB,mBAnBlBC,SAAkBzF,IAAAA,SACtB,GAAIA,EAAKyH,OAASsB,GAA0B,yBAC5CvF,IACA+B,OAAOG,oBAAoB,UAAWD,GAHN,iBAOdzF,EAAK0G,OADf1G,EAAK0G,OAIT1G,EAAKuH,UAAY,mCGnGSyB,EAAaC,OAC/C,GAAmB,MAAfD,GAA+B,MAARC,EAAc,uBAAO,IAEhD,IAAM7G,EAAM,IAAIC,IAAI2G,GAHiC,OAIrD5G,EAAII,aAAaT,OAAO,OAAQkH,mBAEbnF,MAAM1B,EAAK,CAC5B2B,OAAQ,MACRC,QAAS,CACPC,eAAgB,sBAEjBL,KAAK,SAAAO,UAAKA,EAAEC,wBALTrE,GAON,GAAIlF,MAAMC,QAAQiF,GAAO,OAAOA,EAGhC,IAAMwH,EAAW,GAGjB,GAAI1M,MAAMC,QAAQiF,EAAKmJ,gBACrB,cAAoBnJ,EAAKmJ,+BACvB3B,EAAS4B,QACP1B,KAAM,QACNd,MAAO5G,EAAK4G,iBAelB,OARqB,MAAjB5G,EAAKqJ,UACP7B,EAAS4B,QACP1B,KAAM,QACNzG,GAAI,yBACDjB,EAAKqJ,WAIL7B,IAtCT,mCHoGgB8B,CAAcrJ,EAAKsJ,IAAKtJ,EAAKiJ,wBANvC,II9FwBM,EAAUC,EJ8F5BC,EAAM,CACV/C,OACAgD,MACAhB,UAAU,EACVnB,UIlGsBgC,IAAUC,aAAVD,IAAAA,EAAM,aAAIC,IAAAA,EAAM,cAEjCD,EAAQC,KJuFiB,OAehC9O,EAAKiP,GAAMC,GAAkBH,mBACf3K,uBAAd/E,SAhBW,yCAVR,0EAlEH4P,GAAO,eACPtM,GAAU,uBAEVuM,GAAmB,mBAInBb,GAA2B,2BAE3Bc,qGAQAC,YAUO9J,OAET,OADA+J,aAAaC,QAAQL,GAAMzO,KAAKC,UAAU6E,oBACnCA,GAFN,oCAMCtD,WACHC,YAAaC,aACZA,EAAII,4CAhBJ,IAAMiN,EAAW/O,KAAKmK,MAAMwE,IACtBK,EAAShP,KAAKmK,MAAM0E,aAAaI,QAAQR,KAC/C,OAAc,MAAVO,GAAkBD,EAASG,UAAYF,EAAOE,SAChDL,aAAaM,WAAWV,oBACjBM,oBAEFC,GAAUD,GAPhB,mCAiBeH,qBAAhBQ,OAAA1N,OAFU,sCAIXK,GAAY,SAACL,EAAKM,GACjBN,EAAIO,UAAUD,EAAOE,MACrBR,EAAIlC,KAAKwC,EAAOE,KAAMC,GAAST,EAAIU,UAEpCC,GAAc,SAACX,EAAKM,GACnBN,EAAIY,YAAYN,EAAOE,SATb,kBAWOR,EAAKM,OAAW,OACjCA,EAAOQ,MAAMd,EAAIU,yBAZP,sCAcXsM,aAA0BhN,EAAKM,EAAQ8C,OAAS,OAC/CpD,EAAII,MAAMgD,GACV8J,GAAgBlN,EAAIU,OACpBV,EAAIiB,UAAUR,GAAST,EAAIU,yBAjBjB,sCAAA,0BAmBeV,EAAKM,OAAW,OACzCN,EAAII,MAAM9B,KAAKmK,MAAMwE,KACrBC,GAAgBlN,EAAIU,OACpBV,EAAIiB,UAAUR,GAAST,EAAIU,yBAtBjB,sCAAA,sBAwBWV,EAAKM,SAASmD,IAAAA,QAAS,OAC5CnD,EAAOQ,MAAM,CAAC2C,IAAAA,EAAKyF,MAAOlJ,EAAI3C,IAAI,OAAQ,MAAO6B,MAAOyO,sBAzB9C,uCA8BRhE,GAAmB,kBAAMtI,EAAMvB,GAAUiN,KAoC/C,SAASa,KACPjE,KACA7L,EAAKiP,GAjGkB,oBA8HzB,SAASc,GAAMpK,GACb,sBAAmC,OACjCkG,qBACMC,sBACN,OAAO9L,EAAKiP,GAjIK,eAiIe,CAACtJ,IAAAA,GAAM,CAACqK,aAAa,EAAMC,QAAS,OAHtE,oCAOF,SAASxN,GAAUgB,GACjBoI,KACA,IACM1J,EAAOoB,WAAYrB,aAAO,OAC9BA,EAAIlC,KAAKiP,GAAM1M,mBAoGZ,SAAc2N,EAAMC,EAAQ/I,GAElC,IADA,IAAIgJ,IACK,CACR,IAAIC,EAAiBH,IAIrB,GAHIpC,GAAeuC,KAClBA,EAAiBA,EAAe5E,IAE5B4E,EACJ,OAAOtH,EAER,GAAIsH,EAAenH,KAAM,CACxBkH,EAAQ,EACR,MAED,IAAIrH,EAAS3B,IACb,GAAI2B,GAAUA,EAAOG,KAAM,CAC1B,IAAI4E,GAAe/E,GAEZ,CACNqH,EAAQ,EACR,MAHArH,EAASA,EAAOsC,GAcnB,IAAIH,EAAO,IAAIsC,GACXzJ,EAASwH,GAAQC,KAAK,KAAMN,EAAM,GAEtC,OADW,IAAVkF,EAAcC,EAAenH,KAAKoH,GAA8B,IAAVF,EAAcrH,EAAOG,KAAKqH,SAT3EC,GAS2GtH,KAwCjH,YACKmH,EAAiBH,KAChBG,EAAenH,KAClBmH,EAAenH,KAAKoH,GAAkBpH,UAAK,EAAQnF,GAEnDuM,EAAiBD,GAGlB9E,GAAQL,EAAM,EAAGnC,MAhDwHG,UAAK,EAAQnF,GACjJmH,EACP,SAASqF,EAAiBnF,GACzBrC,EAASqC,EACT,EAAG,CASF,KADAiF,EAAiBH,MACOpC,GAAeuC,KAAoBA,EAAe5E,EAEzE,YADAF,GAAQL,EAAM,EAAGnC,GAGlB,GAAIsH,EAAenH,KAElB,YADAmH,EAAenH,KAAKoH,GAAkBpH,UAAK,EAAQnF,GAIhD+J,GADJ/E,EAAS3B,OAER2B,EAASA,EAAO0C,UAER1C,IAAWA,EAAOG,MAC5BH,EAAOG,KAAKqH,GAAkBrH,UAAK,EAAQnF,GAE5C,SAASuM,EAAiBD,GACrBA,GACHtH,EAAS3B,MACK2B,EAAOG,KACpBH,EAAOG,KAAKqH,GAAkBrH,UAAK,EAAQnF,GAE3CwM,EAAiBxH,GAGlBwC,GAAQL,EAAM,EAAGnC,0BAzKT,uCACgB7G,EAAIuO,yBAAnBjO,GACN,GALS,UAKLA,EAAOkO,WACTxO,EAAIlC,KAAKiP,GAAMpM,QADQ8N,KAIzBlN,EAASjB,EAAO8C,WARF,qCAWlB,yBAAatF,EAAKmC,EAZL,UAef,SAASiC,KAEP,OADAyH,KACO7L,EAAKiP,GA3JG,WA2Ja,KAAM,CAACe,aAAa,EAAMC,QAAS,IAWjE,IAAaW,GAAc,WACzB,MAAO,CACL9E,aAAAA,GACAgE,eAAAA,GACAnE,cAAAA,GACAoE,MAAAA,GACAtN,UAAAA,GACA2B,SAAAA,KK/KS0H,GAAe,kBAAM8E,KAAc9E,gBACnCgE,GAAiB,kBAAMc,KAAcd,kBA8BrCJ,GAAU"}