var e=require("rlp"),n=function(e){return c(a(e))},r=function(e){return c(i(e))},t=function(e,n){return Buffer.from(e.padStart(2*n,0),"hex")},u=function(e){return t(e,8)},o=function(e){return Buffer.from(JSON.stringify(e),"utf8")},c=function(n){return e.encode(n).toString("hex")},a=function(e){return d(e),[(r=e.script,Buffer.from(r,"utf8")),e.arguments.map(o),(n=e.refBlock,t(n,32)),e.gasLimit,u(e.proposalKey.address),e.proposalKey.keyId,e.proposalKey.sequenceNum,u(e.payer),e.authorizers.map(u)];var n,r},i=function(e){return p(e),[a(e),f(e)]},f=function(e){var n=s(e);return e.payloadSigs.map(function(e){return{signerIndex:n.get(e.address),keyId:e.keyId,sig:e.sig}}).sort(function(e,n){return e.signerIndex>n.signerIndex?1:e.signerIndex<n.signerIndex?-1:e.keyId>n.keyId?1:e.keyId<n.keyId?-1:void 0}).map(function(e){return[e.signerIndex,e.keyId,(n=e.sig,Buffer.from(n,"hex"))];var n})},s=function(e){var n=new Map,r=0,t=function(e){n.has(e)||(n.set(e,r),r++)};return t(e.proposalKey.address),t(e.payer),e.authorizers.forEach(t),n},d=function(e){k.forEach(function(n){return v(e,n)}),g.forEach(function(n){return v(e.proposalKey,n,"proposalKey")})},p=function(e){I.forEach(function(n){return v(e,n)}),e.payloadSigs.forEach(function(e,n){x.forEach(function(r){return v(e,r,"payloadSigs",n)})})},l=function(e){return"number"==typeof e},h=function(e){return"string"==typeof e},m=function(e){return null!==e&&"object"==typeof e},y=function(e){return m(e)&&e instanceof Array},k=[{name:"script",check:h},{name:"arguments",check:y},{name:"refBlock",check:h,defaultVal:"0"},{name:"gasLimit",check:l},{name:"proposalKey",check:m},{name:"payer",check:h},{name:"authorizers",check:y}],g=[{name:"address",check:h},{name:"keyId",check:l},{name:"sequenceNum",check:l}],I=[{name:"payloadSigs",check:y}],x=[{name:"address",check:h},{name:"keyId",check:l},{name:"sig",check:h}],v=function(e,n,r,t){var u=n.name,o=n.check,c=n.defaultVal;if(null==e[u]&&null!=c&&(e[u]=c),null==e[u])throw K(u,r,t);if(!o(e[u]))throw S(u,r,t)},E=function(e,n,r){return n?null==r?n+"."+e:n+"."+r+"."+e:e},K=function(e,n,r){return new Error("Missing field "+E(e,n,r))},S=function(e,n,r){return new Error("Invalid field "+E(e,n,r))};export{r as encodeTransactionEnvelope,n as encodeTransactionPayload};
//# sourceMappingURL=encode.modern.js.map
