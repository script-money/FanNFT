{"version":3,"file":"fcl-config.modern.js","sources":["../src/fcl-config.js"],"sourcesContent":["import os from \"os\"\nimport path from \"path\"\nimport fs from \"fs\"\n\nconst TARGET = \"flow.json\"\nlet CONFIG = null\n\nfunction isDir(dir) {\n  return fs.lstatSync(dir).isDirectory()\n}\n\nfunction listFiles(dir) {\n  return new Set(fs.readdirSync(dir))\n}\n\nfunction parentDir(dir) {\n  return path.dirname(dir)\n}\n\nfunction findTarget(dir) {\n  if (!isDir(dir)) throw new Error(`Not a directory: ${dir}`)\n  return listFiles(dir).has(TARGET) ? path.resolve(dir, TARGET) : null\n}\n\nfunction recSearch(dir) {\n  const filePath = findTarget(dir)\n\n  if (filePath == null) {\n    if (dir === os.homedir()) throw new Error(\"No flow.json found\")\n    return recSearch(parentDir(dir))\n  }\n\n  CONFIG = JSON.parse(fs.readFileSync(filePath, \"utf8\"))\n  return flowConfig()\n}\n\nexport function flowConfig() {\n  return CONFIG == null ? recSearch(process.cwd()) : CONFIG\n}\n"],"names":["CONFIG","flowConfig","recSearch","dir","filePath","fs","lstatSync","isDirectory","isDir","Error","Set","readdirSync","listFiles","has","path","resolve","findTarget","os","homedir","dirname","parentDir","JSON","parse","readFileSync","process","cwd"],"mappings":"wDAIA,IACIA,EAAS,cA+BGC,IACd,OAAiB,MAAVD,EAbT,SAASE,EAAUC,GACjB,IAAMC,EANR,SAAoBD,GAClB,IAbF,SAAeA,GACb,OAAOE,EAAGC,UAAUH,GAAKI,cAYpBC,CAAML,GAAM,UAAUM,0BAA0BN,GACrD,OAVF,SAAmBA,GACjB,WAAWO,IAAIL,EAAGM,YAAYR,IASvBS,CAAUT,GAAKU,IAjBT,aAiBuBC,EAAKC,QAAQZ,EAjBpC,aAiBmD,KAI/Ca,CAAWb,GAE5B,GAAgB,MAAZC,EAAkB,CACpB,GAAID,IAAQc,EAAGC,UAAW,UAAUT,MAAM,sBAC1C,OAAOP,EAdX,SAAmBC,GACjB,OAAOW,EAAKK,QAAQhB,GAaDiB,CAAUjB,IAI7B,OADAH,EAASqB,KAAKC,MAAMjB,EAAGkB,aAAanB,EAAU,SACvCH,IAIiBC,CAAUsB,QAAQC,OAASzB"}